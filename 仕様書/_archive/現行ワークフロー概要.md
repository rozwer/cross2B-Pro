# SEO記事自動生成システム - 現行ワークフロー概要

**作成日**: 2025年12月9日
**バージョン**: 1.0
**目的**: 手動実行されている記事生成ワークフローの全体像を簡潔に整理

---

## エグゼクティブサマリー

本システムは、複数AI（Gemini, Claude, GPT）を組み合わせてSEO最適化記事を生成する多段階ワークフローです。

**現状の課題**:
- 各工程の出力ファイル（JSON/Markdown/CSV）を**人手で次工程に受け渡し**
- 1記事あたり**約2時間**を要している
- ファイル添付制限（10ファイル）への対応が煩雑

**目標**:
- 工程-1〜3: **半自動化**（人の確認を挟む）
- 工程4〜10: **全自動化**（一気通貫実行）
- 所要時間を**30分以下**に短縮

---

## 全体フロー構造

### フロー区分

```
【半自動フロー】人間確認あり
工程-1 → 工程0 → 工程1 → 工程2 → 工程3A/3B/3C（並列）
                                    ↓
                              [人間確認ポイント]
                                    ↓
【全自動フロー】一気通貫実行
工程4 → 工程5 → 工程6 → 工程6.5 → 工程7A → 工程7B → 工程8 → 工程9 → 工程10
```

---

## 工程別詳細

### 【半自動フロー】工程-1 〜 工程3

#### 工程-1: 絶対条件ヒアリング
- **実行方法**: Googleフォーム（手動入力）
- **入力**: ユーザー回答
- **出力**: `スプレッドシート`（ヒアリング結果）
- **収集内容**:
  - 事業内容、ターゲット読者、自社の強み
  - キーワード選定（既存/未選定）
  - 記事戦略（標準/トピッククラスター）
  - 文字数設定モード（manual / ai_seo_optimized / ai_readability / ai_balanced）
  - CTA設計（単一/段階的）

#### 工程0: キーワード選定
- **AI**: Gemini
- **入力**: 工程-1のスプレッドシート
- **出力**: `工程0_キーワード選定結果.json`
- **処理内容**:
  - メインキーワード確定
  - CTA仕様の構造化
  - 戦略タイプ確定（standard / topic_cluster）
  - 文字数目標設定（manual時）
  - 4本柱評価（神経科学/行動経済学/LLMO/KGI）

**出力例**:
```json
{
  "selected_keyword": "ドライバー 採用 難しい",
  "target_word_count": 10000,
  "strategy": "standard",
  "cta_specification": {
    "design_type": "single",
    "single_cta": {
      "url": "https://crosslink.jp.net/...",
      "text": "ドライバーの応募について相談する",
      "placement": {"early": 650, "mid": 2800, "final": "9500"}
    }
  }
}
```

#### 工程1: 競合記事本文取得
- **実行方法**: Google Apps Script（GAS）
- **入力**: キーワード（スプレッドシートA1セル）
- **出力**: `工程1_1.1統合_上位10サイト競合記事本文.csv`
- **処理内容**:
  - Google Custom Search APIで上位10サイト取得
  - 本文抽出（H2-4, P, Li, Blockquote）
  - 最大5万文字/記事

#### 工程2: CSV読み込み・初期化
- **AI**: Gemini
- **入力**: 工程1のCSV
- **出力**: **なし**（テキストレポートのみ）
- **処理内容**: データ検証のみ。加工はせず、後続工程は工程1のCSVを直接参照

#### 工程3A: クエリ分析・ペルソナ深掘り（並列実行）
- **AI**: Gemini
- **入力**: 工程0のJSON + 工程1のCSV
- **出力**: `工程3A_クエリ分析結果.json`
- **処理内容**:
  - 検索意図分析（Know/Do/Buy）
  - ペルソナ詳細化（年齢、職業、心理状態、検索シナリオ）
  - 3フェーズ心理マッピング（Anxiety/Understanding/Action）
  - 行動経済学プロファイル（損失回避/社会的証明/権威性など）

#### 工程3B: 共起語・関連キーワード抽出（並列実行）
- **AI**: Gemini
- **入力**: 工程0のJSON + 工程1のCSV
- **出力**: `工程3B_共起語抽出結果.json`
- **重要度**: **システムの心臓部**
- **処理内容**:
  - 共起語100-150個抽出
  - 3カテゴリ分類（Essential/Standard/Unique）
  - 3フェーズマッピング
  - LLMO要素抽出、行動経済学トリガー

#### 工程3C: 競合分析・差別化切り口発見（並列実行）
- **AI**: Gemini
- **入力**: 工程0のJSON + 工程1のCSV
- **出力**: `工程3C_競合分析結果.json`
- **処理内容**:
  - 文字数統計分析
  - target_word_count算出（ai_*モード時のみ）
  - コンテンツギャップ分析
  - 差別化戦略提案

**→ 人間確認ポイント**: 工程3A/B/Cの分析結果をレビュー・承認

---

### 【全自動フロー】工程4 〜 工程10

#### 工程4: 戦略的アウトライン生成
- **AI**: Claude
- **入力**: 工程0,1,3A,3B,3Cの全出力
- **出力**: `工程4_戦略的アウトライン.json`
- **処理内容**:
  - タイトル候補3案生成
  - 記事構造設計（10-13セクション）
  - 3フェーズ配分（Phase1:10-15% / Phase2:65-75% / Phase3:10-15%）
  - 各H2に4本柱を埋め込み（神経科学/行動経済学/LLMO/KGI）
  - 3段階CTA配置戦略

**4本柱の実装**:
- **神経科学**: 認知負荷3概念以内、文長20-35文字、脳の3領域（扁桃体/前頭前野/線条体）への訴求
- **行動経済学**: 6原則（損失回避/社会的証明/権威性/希少性/一貫性/好意）の配置
- **LLMO**: 400-600 tokens/section、セクション独立性、構造化データ
- **KGI**: CTA配置（Early:650字/Mid:2800字/Final:約9500字）

#### 工程5: 一次情報追加・知識ギャップ解消
- **AI**: Gemini + Web検索
- **入力**: 工程0〜4の全出力
- **出力**: `工程5_一次情報収集結果.json`
- **処理内容**:
  - 最新一次情報収集（15-25個）
  - 公的機関優先（厚労省、国交省、業界団体等）
  - データ年優先順位: 2025年 > 2024年 > 2023年 > 2022年以前（避ける）

#### 工程6: アウトライン再生成（強化版）
- **AI**: Claude
- **入力**: 工程0〜5の全出力
- **出力**: `工程6_アウトライン強化版.json`
- **処理内容**:
  - 工程4のアウトライン + 工程5の一次情報を統合
  - 4本柱の明示的埋め込み
  - データアンカー配置
  - 引用形式統一
  - トークン数管理

#### 工程6.5: 構成案作成・統合パッケージ化 ⭐最重要
- **AI**: Claude
- **入力**: 工程6の強化版アウトライン + 全参照データ
- **出力**: `工程6.5_統合パッケージ.md`
- **重要性**: **ファイル添付数削減の要**
- **構成**:
  ```markdown
  # 【パート1】構成案（概要）
  - 導入部の論理展開
  - 各H2セクションの論理展開、配置する一次情報、視覚要素

  # 【パート2】参照用データ
  - 工程0の設定（CTA、文字数、戦略）
  - 工程5の一次情報リスト
  - 工程6のアウトライン要約
  ```
- **効果**: **工程7以降はこのファイル1つで実行可能**

#### 工程7A: 本文生成 初稿
- **AI**: Claude
- **入力**: `工程6.5_統合パッケージ.md`のみ
- **出力**: `工程7A_本文初稿.md`
- **処理内容**:
  - 構成案の完全実装
  - 10重チェック + 4本柱チェック
  - **文字数トラッキング（早期警告システム）**
  - 分割執筆方式（H2ごと）
  - 文字数目標達成（±15%許容）

**早期警告システム**:
- -1000字以上の乖離で警告表示
- 補足セクションの提案

#### 工程7B: 本文生成 ブラッシュアップ
- **AI**: Gemini
- **入力**: 工程7Aの初稿
- **出力**: `工程7B_本文ブラッシュアップ版.md`
- **処理内容**: 読みやすさの向上
- **絶対変更禁止事項**:
  - データ・数値
  - 引用・出典
  - 構造（H2/H3）
  - CTA

#### 工程8: ファクトチェック・FAQ生成
- **AI**: Gemini + Web検索
- **入力**: 工程7Bのブラッシュアップ版
- **出力**:
  - `工程8_ファクトチェック結果.json`
  - `工程8_FAQ統合版.md`
- **処理内容**:
  - **工程8A**: データアンカー検証、引用元実在確認
  - **工程8B**: FAQ生成（10-15個）、音声検索最適化

#### 工程9: 最終リライト・品質向上
- **AI**: Claude
- **入力**: 工程8の出力（ファクトチェック結果 + FAQ統合版）
- **出力**:
  - `工程9_最終リライト版.md`
  - `工程9_修正レポート.json`
- **処理内容**（優先順位順）:
  1. **文字数監査（最優先）**
  2. 見出し整理（H2-/H3-などのプレフィックス削除）
  3. 冗長性・重複チェック
  4. CTA最終確認
  5. 品質スコア算出（目標: 0.90以上）

#### 工程10: SEO記事完成・最終出力
- **AI**: Claude
- **入力**: 工程9の最終リライト版
- **出力**: 公開用パッケージ
  1. `工程10_final_article.md` - 記事本文
  2. `工程10_final_article.html` - HTML版
  3. `工程10_meta_info.json` - メタ情報
  4. `工程10_publication_checklist.md` - 公開用チェックリスト
  5. `工程10_comprehensive_report.json` - 総合レポート

**レポート機能**:
- 文字数トラッキング可視化
- セクションバランス分析
- 競合文字数比較
- 自動補足特定

---

## AIプロバイダー割り当て

| 工程 | 使用AI | 選定理由 |
|------|--------|----------|
| 工程-1 | 手動 | Googleフォーム |
| 工程0 | Gemini | キーワード分析の精度 |
| 工程1 | GAS | Google検索API連携 |
| 工程2 | Gemini | CSV処理の安定性 |
| 工程3A/B/C | Gemini | 並列分析、Web検索連携 |
| **工程4** | **Claude** | 構造化出力の品質 |
| 工程5 | Gemini + Web | Web検索連携 |
| **工程6** | **Claude** | 統合・再構成の品質 |
| **工程6.5** | **Claude** | 構成案の品質 |
| **工程7A** | **Claude** | 長文生成の品質 |
| 工程7B | Gemini | ブラッシュアップの自然さ |
| 工程8 | Gemini + Web | ファクトチェック、Web検索 |
| **工程9** | **Claude** | 最終リライトの品質 |
| **工程10** | **Claude** | 最終出力の品質 |

**パターン**:
- **Gemini**: 分析、検索、自然な表現
- **Claude**: 構造化、統合、品質制御

---

## ファイルフロー

### 工程間のデータ受け渡し

```
工程-1  → [スプレッドシート]
工程0   → [工程0_キーワード選定結果.json]
工程1   → [工程1_1.1統合_上位10サイト競合記事本文.csv]
工程2   → なし（テキストレポートのみ）
工程3A  → [工程3A_クエリ分析結果.json]
工程3B  → [工程3B_共起語抽出結果.json]
工程3C  → [工程3C_競合分析結果.json]
---人間確認---
工程4   → [工程4_戦略的アウトライン.json]
工程5   → [工程5_一次情報収集結果.json]
工程6   → [工程6_アウトライン強化版.json]
工程6.5 → [工程6.5_統合パッケージ.md] ⭐ここから1ファイルのみ
工程7A  → [工程7A_本文初稿.md]
工程7B  → [工程7B_本文ブラッシュアップ版.md]
工程8   → [工程8_ファクトチェック結果.json] + [工程8_FAQ統合版.md]
工程9   → [工程9_最終リライト版.md] + [工程9_修正レポート.json]
工程10  → [final_article.md/html] + [meta_info.json] + [publication_checklist.md] + [comprehensive_report.json]
```

### 工程6.5の重要性

**問題**: 工程7以降、10ファイル制限に引っかかる
- 工程0,1,3A,3B,3C,4,5,6の8ファイル + プロンプトファイル = 制限超過

**解決策**: 工程6.5で全情報を1つのMarkdownファイルに統合
- パート1: 人間が読める構成案
- パート2: AI実行用の参照データ（JSON埋め込み）

**効果**: 工程7〜10は`工程6.5_統合パッケージ.md`のみを受け渡し

---

## 現行の手動作業

### 各工程での人手作業

1. **ファイル受け渡し**:
   - 工程Nの出力を確認
   - 次工程のAIチャットにファイルを添付
   - プロンプトファイルも添付

2. **プロンプト実行**:
   - `conversation_starter.txt`を送信
   - AIの応答を確認
   - `instructions.txt`の指示に従って実行

3. **出力保存**:
   - AIの出力をコピー
   - ファイルとして保存（JSON/Markdown）

4. **品質チェック**:
   - 出力内容の妥当性確認
   - エラーがあれば修正指示

**所要時間**: 工程あたり5-10分 × 14工程 = **約2時間**

---

## 自動化のための要件

### 半自動フロー（工程-1〜3）

- Googleフォーム → スプレッドシート連携
- スプレッドシートからJSON自動変換
- 工程0,1,2,3A,3B,3Cの順次実行
- 工程3完了後、管理画面で確認・承認UI

### 全自動フロー（工程4〜10）

- 承認後、工程4〜10を一気通貫実行
- 各工程の入出力ファイルを自動受け渡し
- プロンプトテンプレート自動読み込み
- エラー時のリトライ機構
- 進捗状況のリアルタイム表示

### ファイル管理

```
/projects/[project_id]/
  /input/
    hearing_result.json
  /process/
    /step0/
      keyword_selection.json
    /step1/
      competitors.csv
    /step2/
      (レポートのみ、ファイルなし)
    /step3/
      query_analysis.json
      keyword_strategy.json
      competitive_analysis.json
    /step4/
      outline_v1.json
    ...
  /output/
    final_article.md
    final_article.html
    meta_info.json
    publication_checklist.md
    comprehensive_report.json
```

---

## 重要な実行ルール

### AI実行ルール（ステップ・バイ・ステップ）

全工程のAI処理で以下を厳守:

1. **タスク宣言**: 「今からタスク1 ([タスク名])を実行します」
2. **単一実行**: 1タスクのみ実行
3. **出力マーカー**: 成果物を`【OUTPUT_START 1/N】`〜`【OUTPUT_END 1/N】`で囲む
4. **承認待ち**: ユーザーの「次のタスクに進んでください」を待つ
5. **省略禁止**: JSON/Markdownの表示を省略しない

### 文字数トラッキング

各工程で文字数を記録:
- 工程4: 計画文字数
- 工程7A: 初稿文字数
- 工程7B: ブラッシュアップ後
- 工程9: 最終文字数

**達成基準**: targetWordCount ± 15%以内

---

## 付録: 用語集

- **4本柱**: 神経科学/行動経済学/LLMO/KGI
- **3フェーズ**: Phase1(Anxiety)/Phase2(Understanding)/Phase3(Action)
- **CTA**: Call To Action（問い合わせ誘導）
- **データアンカー**: 信頼性を担保する一次情報の引用
- **RJP**: Realistic Job Preview（正直な仕事紹介）
- **LLMO**: Large Language Model Optimization（AI引用最適化）
