-- ============================================================================
-- help_contents テーブル: 画像生成関連ヘルプの改良版
-- ============================================================================
-- 実行方法:
--   psql -U seo -d seo_common -f scripts/sql/help_contents_image_update.sql
-- ============================================================================

-- ----------------------------------------------------------------------------
-- image.settings: 画像設定と各スタイルの特徴
-- ----------------------------------------------------------------------------

INSERT INTO help_contents (help_key, title, content, category, display_order)
VALUES (
    'image.settings',
    '画像設定と各スタイルの特徴',
    '## 画像設定

記事に挿入するAI生成画像の基本設定です。スタイル選択が品質を大きく左右します。

### 画像枚数の目安

| 記事文字数 | 推奨枚数 | 理由 |
|-----------|---------|------|
| 2,000字以下 | 1〜2枚 | アイキャッチ+本文1枚で十分 |
| 3,000〜5,000字 | 3〜5枚 | 各セクションに1枚が理想 |
| 5,000字以上 | 5〜8枚 | 視覚的な休憩ポイントとして |

### 画像スタイル詳細

| スタイル | 仕上がりイメージ | ベストな使用シーン |
|---------|-----------------|-------------------|
| **写真風** | 自然光で撮影したような高解像度画像。人物・オフィス風景など | BtoB記事、導入事例、インタビュー |
| **イラスト** | 柔らかい線画と淡い色使い。キャラクターや概念図 | 初心者向け解説、親しみやすいブログ |
| **インフォグラフィック** | グラフ・チャート・フロー図風のデータ可視化 | 統計紹介、比較記事、手順説明 |
| **フラットデザイン** | シンプルな図形と鮮やかな配色のアイコン的表現 | テック系記事、モダンなイメージ |
| **抽象アート** | 幾何学模様やグラデーション。概念を象徴的に表現 | コンセプト説明、ブランディング記事 |

### サイズ選択のポイント

- **横長（16:9）**: ブログ本文・アイキャッチに最適。最も汎用的
- **正方形（1:1）**: Instagram/Facebookシェア用。SNS連携重視なら
- **縦長（9:16）**: スマホファーストのLP、Stories用

### ブランドカラー活用

HEXコード（例: #1E40AF）を指定すると画像全体のトーンに反映されます。複数色を使いたい場合もメインカラー1色を推奨。統一感のある記事に仕上がります。',
    'image',
    10
)
ON CONFLICT (help_key) DO UPDATE SET
    title = EXCLUDED.title,
    content = EXCLUDED.content,
    category = EXCLUDED.category,
    display_order = EXCLUDED.display_order,
    updated_at = NOW();

-- ----------------------------------------------------------------------------
-- image.positions: 挿入位置の選び方と効果的な配置戦略
-- ----------------------------------------------------------------------------

INSERT INTO help_contents (help_key, title, content, category, display_order)
VALUES (
    'image.positions',
    '挿入位置の選び方と効果的な配置',
    '## 画像挿入位置

画像の配置場所で記事の読みやすさとエンゲージメントが大きく変わります。

### AI提案機能の活用

「位置を提案」ボタンでAIが最適な挿入位置を分析します。提案基準は以下の通りです。

| 提案される位置 | AIの判断基準 |
|---------------|-------------|
| 見出し直後 | セクション内容を視覚的に補強できる箇所 |
| 概念説明の後 | 抽象的な説明を具体化できる箇所 |
| データ・統計の前後 | グラフや図で理解を促進できる箇所 |
| 手順の区切り | ステップを視覚的に分離できる箇所 |

### 配置パターンと効果

| 配置パターン | 効果 | 適した記事タイプ |
|-------------|------|-----------------|
| **アイキャッチのみ** | SNSシェア時の訴求力UP | ニュース、速報系 |
| **導入+結論** | 記事全体の印象付け | 解説記事、コラム |
| **各H2セクション** | 読者の離脱防止、理解促進 | 長文記事、ハウツー |
| **ステップごと** | 手順の明確化 | チュートリアル、マニュアル |

### 避けるべき配置

- **連続配置**: 画像が2枚以上連続すると読み飛ばされやすい
- **文章途中**: 文脈が切れて読みにくくなる
- **過密配置**: 500字未満に複数画像は逆効果

### 位置の調整方法

1. **ドラッグ&ドロップ**: 画像を掴んで移動
2. **挿入ポイント選択**: プレビュー上でクリック
3. **削除**: 画像横の「×」ボタン

### モバイル表示の注意点

画面幅が狭いモバイルでは画像の占有率が高くなります。プレビューで必ずモバイル表示を確認してください。',
    'image',
    20
)
ON CONFLICT (help_key) DO UPDATE SET
    title = EXCLUDED.title,
    content = EXCLUDED.content,
    category = EXCLUDED.category,
    display_order = EXCLUDED.display_order,
    updated_at = NOW();

-- ----------------------------------------------------------------------------
-- image.instructions: プロンプトのコツとNGパターン
-- ----------------------------------------------------------------------------

INSERT INTO help_contents (help_key, title, content, category, display_order)
VALUES (
    'image.instructions',
    'プロンプトのコツとNGパターン',
    '## 画像生成プロンプトの書き方

プロンプト（指示文）の質が生成結果を決定します。コツを押さえて高品質な画像を生成してください。

### 基本構成（推奨フォーマット）

```
[被写体] + [状況・動作] + [スタイル] + [色調・雰囲気]
```

### 良いプロンプトの例

| 目的 | プロンプト例 |
|------|-------------|
| ビジネスシーン | 「モダンなオフィスでノートPCを操作する30代女性、窓からの自然光、プロフェッショナルで清潔感のある雰囲気」 |
| データ可視化 | 「売上推移を示す右肩上がりの棒グラフ、青と緑のグラデーション、白背景、モダンなインフォグラフィック風」 |
| 概念説明 | 「複数の歯車が噛み合って回転する図、チームワークを象徴、フラットデザイン、パステルカラー」 |

### 効果的なキーワード

| 目的 | 使えるキーワード |
|------|-----------------|
| 明るさ | 「明るい」「自然光」「ソフトライティング」「ハイキー」 |
| 構図 | 「俯瞰」「アイレベル」「クローズアップ」「引きの構図」 |
| 雰囲気 | 「プロフェッショナル」「親しみやすい」「モダン」「ミニマル」 |
| 色調 | 「青を基調」「暖色系」「モノトーン」「パステルカラー」 |

### NGパターン（避けるべき指示）

| NGパターン | 問題点 | 改善例 |
|-----------|--------|--------|
| 「いい感じの画像」 | 曖昧で再現性がない | 具体的な被写体と雰囲気を指定 |
| 「〇〇社のロゴ」 | 商標権侵害の恐れ | ロゴなしのイメージで代替 |
| 「有名人の〇〇」 | 肖像権侵害の恐れ | 「30代男性ビジネスマン」など一般化 |
| 「テキストを入れて」 | AI生成の文字は崩れやすい | 画像のみ生成、文字は後から追加 |
| 「複雑なシーン」 | 破綻しやすい | 要素を絞ってシンプルに |

### プロンプト改善のコツ

1. **具体性を上げる**: 「人」→「30代日本人女性、ショートヘア、スーツ姿」
2. **ネガティブ指定**: 「人物なし」「文字なし」「背景シンプル」
3. **参考スタイル**: 「ミニマルデザイン風」「雑誌広告風」
4. **色を指定**: ブランドカラーに合わせた色調指定

### AIの自動補完について

プロンプトが空欄の場合、記事内容から自動生成されます。ただし、**手動で微調整した方が高品質**な結果になります。',
    'image',
    30
)
ON CONFLICT (help_key) DO UPDATE SET
    title = EXCLUDED.title,
    content = EXCLUDED.content,
    category = EXCLUDED.category,
    display_order = EXCLUDED.display_order,
    updated_at = NOW();

-- ----------------------------------------------------------------------------
-- image.review: 生成画像のレビューとA/Bテスト活用
-- ----------------------------------------------------------------------------

INSERT INTO help_contents (help_key, title, content, category, display_order)
VALUES (
    'image.review',
    '生成画像のレビューとA/Bテスト活用',
    '## 画像のレビュー

生成された画像を確認し、最適なものを選択します。同じ指示でも結果は毎回異なるため、複数バリエーションの活用がおすすめです。

### レビュー画面の見方

各画像カードには以下が表示されます。
- **サムネイル**: 生成された画像
- **プロンプト**: 使用した指示文
- **生成情報**: 日時、スタイル、サイズ

### 評価アクション

| アクション | 用途 | ショートカット |
|-----------|------|---------------|
| **承認** | この画像を採用 | Enter |
| **リトライ** | 同じ指示で再生成 | R |
| **編集して再生成** | 指示を修正して再生成 | E |
| **削除** | この画像を使用しない | Delete |

### 複数バリエーションの活用（A/Bテスト）

同じ挿入位置に対して複数の画像候補を生成し、比較検討できます。

**活用シーン**
- アイキャッチ画像の訴求力比較
- イラスト vs 写真風の効果検証
- 色調の異なるバリエーション比較

**手順**
1. 同じ位置に対して「バリエーション追加」をクリック
2. プロンプトを微調整して複数パターン生成
3. プレビューで切り替えながら比較
4. 最適なものを選択して承認

### リトライ時のプロンプト改善例

| 問題 | 改善方向 | プロンプト追加例 |
|------|---------|-----------------|
| 暗すぎる | 明るさを指定 | 「明るい照明」「ハイキー」「白背景」 |
| 人物が不自然 | 構図を変更 | 「後ろ姿」「手元のみ」「シルエット」 |
| 色味が合わない | 色調を指定 | 「青を基調」「#1E40AF のトーン」 |
| 雑然としている | 要素を減らす | 「シンプルな構図」「背景ぼかし」 |

### コストと回数の目安

- リトライ1回 = 1画像分のコスト
- 推奨: 1位置あたり最大3回まで
- 3回で満足できない場合はプロンプト自体を見直し

### 一括操作

- **全て承認**: 全画像を一括採用（時間優先時）
- **全てリトライ**: 全画像を一括再生成（品質優先時）',
    'image',
    40
)
ON CONFLICT (help_key) DO UPDATE SET
    title = EXCLUDED.title,
    content = EXCLUDED.content,
    category = EXCLUDED.category,
    display_order = EXCLUDED.display_order,
    updated_at = NOW();

-- ----------------------------------------------------------------------------
-- image.preview: プレビュー確認と最終調整
-- ----------------------------------------------------------------------------

INSERT INTO help_contents (help_key, title, content, category, display_order)
VALUES (
    'image.preview',
    'プレビュー確認と最終調整',
    '## 画像プレビュー

画像を記事に統合した状態を、実際の表示に近い形でプレビュー確認できます。ここでの最終確認が公開品質を左右します。

### プレビュー画面の機能

- **統合表示**: 記事本文と画像が実際の配置で表示
- **デバイス切り替え**: デスクトップ/タブレット/モバイル
- **ズーム**: 画像の細部確認
- **インタラクティブ編集**: 位置変更・差し替え

### デバイス別表示サイズ

| モード | 画面幅 | 確認ポイント |
|--------|--------|-------------|
| デスクトップ | 1200px | 画像とテキストのバランス、余白 |
| タブレット | 768px | 2カラム→1カラムの崩れ |
| モバイル | 375px | 画像の占有率、読み込み体験 |

### 確認チェックリスト

**配置バランス**
- [ ] 画像が特定エリアに偏っていないか
- [ ] テキストと画像の比率は適切か（目安: テキスト70% / 画像30%）
- [ ] 連続する画像がないか

**サイズ・品質**
- [ ] 画像が小さすぎて見づらくないか
- [ ] 逆に大きすぎてスクロールが増えていないか
- [ ] 解像度は十分か（ぼやけていないか）

**文脈との整合**
- [ ] 前後のテキスト内容と画像が関連しているか
- [ ] 画像だけ見ても内容が伝わるか
- [ ] キャプション（alt）は適切か

**パフォーマンス**
- [ ] 画像枚数は適切か（読み込み速度への影響）
- [ ] 高解像度すぎる画像はないか

### よくある問題と対処法

| 問題 | 対処法 |
|------|--------|
| 画像と文章が離れすぎ | 画像を該当段落の直後に移動 |
| モバイルで画像が大きすぎ | 横長（16:9）に変更、または画像数を削減 |
| 全体的に重い印象 | 画像枚数を減らす、抽象画像をフラットデザインに |
| 統一感がない | 全画像で同じスタイル・色調を使用 |

### 最終調整の操作

- **位置変更**: 画像をドラッグ&ドロップ
- **画像差し替え**: 画像をクリック→「編集」→別画像を選択
- **削除**: 画像横の「×」ボタン
- **追加**: 挿入したい位置をクリック→新規生成

### 確定して次へ

全ての確認が完了したら「統合を確定」をクリックして工程12（WordPress形式変換）に進みます。確定後も工程11を再実行すれば画像の再編集が可能です。',
    'image',
    50
)
ON CONFLICT (help_key) DO UPDATE SET
    title = EXCLUDED.title,
    content = EXCLUDED.content,
    category = EXCLUDED.category,
    display_order = EXCLUDED.display_order,
    updated_at = NOW();

-- ============================================================================
-- 確認用クエリ
-- ============================================================================
-- SELECT help_key, title, LENGTH(content) as content_length, category, display_order
-- FROM help_contents
-- WHERE help_key LIKE 'image.%'
-- ORDER BY display_order;
