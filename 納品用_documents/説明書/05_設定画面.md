# 設定画面

> URL: http://localhost:3000/settings

システムの各種設定を管理する画面です。5つのタブに分かれています。

---

## タブ一覧

| タブ | URL パラメータ | 説明 |
|------|---------------|------|
| **モデル設定** | `?tab=models` | 各工程で使用するAIモデルの選択 |
| **LLMモデル** | `?tab=llm-models` | 利用可能なモデルの管理 |
| **プロンプト** | `?tab=prompts` | 各工程のプロンプト閲覧・編集 |
| **APIキー** | `?tab=apikeys` | LLM/ツールのAPIキー管理 |
| **GitHub** | `?tab=github` | GitHub連携設定 |

---

## モデル設定タブ

各工程でどのAIモデルを使用するかを設定します。

### 操作方法

1. 各工程の行で、プルダウンからAIプロバイダー（Gemini / Anthropic / OpenAI）を選択
2. 必要に応じて具体的なモデル名を選択
3. 画面右上の **「保存」** をクリック

### 画面上部の表示

- **Gemini: N / Anthropic: N / OpenAI: N** — 各プロバイダーが何工程で使われているかのカウント

### ボタン

| ボタン | 説明 |
|--------|------|
| **リセット** | デフォルト設定に戻す |
| **保存** | 現在の設定を保存 |
| **新規Run** | 現在の設定で新しい記事生成を開始 |

> **注意**: 設定はブラウザのローカルストレージに保存されます。ブラウザのデータをクリアすると設定がリセットされます。

---

## LLMモデルタブ

システムで利用可能なLLMモデルの一覧管理です。

- 各プロバイダー（Gemini, OpenAI, Anthropic）ごとにモデルが表示されます
- モデルの追加・削除・コスト設定が可能です

---

## プロンプトタブ

各工程で使用されるプロンプト（AIへの指示文）を閲覧・編集できます。

### 操作方法

1. 工程ごとにグループ化されたプロンプト一覧が表示されます
2. **検索バー**: キーワードでプロンプトを検索
3. **フィルター**: 特定の工程だけに絞り込み
4. **「編集」ボタン**: プロンプトの内容を編集
5. プロンプトには **バージョン管理** があり、過去のバージョンも確認できます

### プロンプト変数

プロンプト内の `{{変数名}}` は実行時に自動的に置き換えられます。変数名は青色のバッジで表示されます。

> **注意**: プロンプトの編集は記事品質に直接影響します。変更は慎重に行ってください。

---

## APIキータブ

LLMやツールのAPIキーをWeb画面から管理できます。

### 管理できるキー

| サービス | 用途 |
|----------|------|
| **Gemini** | Google Gemini API |
| **OpenAI** | OpenAI API |
| **Anthropic** | Anthropic Claude API |
| **SERP API** | Google検索結果取得 |
| **Google Ads** | キーワードプランナー |
| **GitHub** | GitHub連携 |

### 操作方法

1. サービスカードをクリックして展開
2. **「キーを設定」** または **「キーを変更」** をクリック
3. APIキーを入力して **「保存」**
4. **「接続テスト」** ボタンで正常に接続できるか確認

### セキュリティ

- APIキーは **AES-256-GCM** で暗号化して保存されます
- 画面上では末尾4文字のみが表示されます（例: `****xyz9`）
- GitHubトークンは先頭4文字のみ表示（例: `ghp_****`）

### 優先順位

```
1. この画面で設定したキー（DB保存）  ← 優先
2. .env ファイルで設定したキー       ← フォールバック
```

---

## GitHubタブ

記事をGitHubリポジトリに送信するための連携設定です。

### 設定項目

| 項目 | 説明 |
|------|------|
| **GitHub Token** | GitHubのPersonal Access Token |
| **リポジトリ** | 記事を送信するリポジトリ |
| **ブランチ** | 送信先ブランチ |

### GitHub Tokenの取得方法

1. GitHub → Settings → Developer settings → Personal access tokens → Fine-grained tokens
2. 「Generate new token」をクリック
3. 必要なスコープ: `repo`（リポジトリへの読み書き）
4. 生成されたトークンをこの画面に設定

---

## 「新規Run」ボタン

設定画面の右上に常に表示される緑色のボタンです。クリックすると新規記事作成ウィザードに遷移します。モデル設定タブで設定を変更した場合、自動的に保存してからウィザードに遷移します。
