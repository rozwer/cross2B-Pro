{
    "process_info": {
        "name": "工程13: WordPress自動投稿",
        "version": "1.0",
        "purpose": "工程12のHTMLをWordPress REST APIで自動投稿する",
        "note": "このJSONにはAPI仕様・エラー対応・セキュリティガイドラインが含まれています"
    },
    "prerequisites": {
        "wordpress_requirements": {
            "minimum_version": "5.6",
            "required_features": [
                "REST API有効",
                "Application Passwords有効",
                "HTTPS（SSL）推奨"
            ]
        },
        "authentication": {
            "method": "Application Passwords",
            "setup_steps": [
                "WordPress管理画面 → ユーザー → プロフィール",
                "「アプリケーションパスワード」セクションまでスクロール",
                "新しいアプリケーション名を入力（例: SEO自動投稿）",
                "「新しいアプリケーションパスワードを追加」をクリック",
                "生成されたパスワードを安全な場所に保存"
            ],
            "format": "Basic認証（ユーザー名:アプリパスワード）"
        },
        "python_requirements": {
            "version": "3.7+",
            "libraries": ["requests"]
        }
    },
    "api_reference": {
        "base_url": "{site_url}/wp-json/wp/v2",
        "endpoints": {
            "posts": {
                "url": "/posts",
                "method": "POST",
                "description": "記事を作成",
                "request_body": {
                    "title": "記事タイトル（必須）",
                    "content": "HTMLコンテンツ（必須）",
                    "status": "draft / publish / pending / private",
                    "categories": "カテゴリIDの配列 [1, 2]",
                    "tags": "タグIDの配列 [10, 11]",
                    "featured_media": "アイキャッチ画像のメディアID",
                    "excerpt": "抜粋",
                    "slug": "パーマリンク",
                    "meta": "カスタムフィールド"
                },
                "response": {
                    "id": "作成された投稿ID",
                    "link": "投稿URL",
                    "status": "投稿ステータス"
                }
            },
            "media": {
                "url": "/media",
                "method": "POST",
                "description": "メディア（画像）をアップロード",
                "headers": {
                    "Content-Type": "image/jpeg または image/png",
                    "Content-Disposition": "attachment; filename=\"filename.jpg\""
                },
                "response": {
                    "id": "アップロードされたメディアID",
                    "source_url": "画像URL"
                }
            },
            "categories": {
                "url": "/categories",
                "method": "GET",
                "description": "カテゴリ一覧を取得"
            },
            "tags": {
                "url": "/tags",
                "method": "GET / POST",
                "description": "タグの取得・作成"
            }
        }
    },
    "post_statuses": {
        "draft": {
            "description": "下書き",
            "recommended": true,
            "note": "最初は下書きで投稿し、確認後に公開することを推奨"
        },
        "publish": {
            "description": "公開",
            "recommended": false,
            "note": "即時公開される。確認なしの公開は注意"
        },
        "pending": {
            "description": "レビュー待ち",
            "note": "編集者/管理者の承認が必要"
        },
        "private": {
            "description": "非公開",
            "note": "ログインユーザーのみ閲覧可能"
        },
        "future": {
            "description": "予約投稿",
            "note": "dateパラメータで公開日時を指定"
        }
    },
    "error_handling": {
        "common_errors": {
            "401": {
                "message": "Unauthorized",
                "cause": "認証失敗",
                "solution": "ユーザー名・アプリパスワードを確認"
            },
            "403": {
                "message": "Forbidden",
                "cause": "権限不足",
                "solution": "ユーザーに投稿権限があるか確認（投稿者以上）"
            },
            "404": {
                "message": "Not Found",
                "cause": "エンドポイントが見つからない",
                "solution": "site_urlとREST APIが有効か確認"
            },
            "500": {
                "message": "Internal Server Error",
                "cause": "サーバー側のエラー",
                "solution": "WordPressのエラーログを確認"
            }
        },
        "troubleshooting": {
            "app_password_not_shown": [
                "WordPress 5.6以上か確認",
                "HTTPS（SSL）が有効か確認",
                "プラグインの競合を確認（一時的に無効化）",
                "wp-config.phpでDISALLOW_APPLICATION_PASSWORDSがtrueになっていないか確認"
            ],
            "rest_api_disabled": [
                "パーマリンク設定を確認（基本以外に設定）",
                "セキュリティプラグインがブロックしていないか確認",
                ".htaccessの設定を確認"
            ]
        }
    },
    "security": {
        "critical_rules": [
            "config.jsonを公開リポジトリにコミットしない",
            "HTTPSを必ず使用する",
            "最小権限の原則（投稿専用ユーザーを作成）",
            "アプリパスワードを定期的にローテーション",
            "不要になったアプリパスワードは削除"
        ],
        "recommended_user_role": "投稿者（Author）または 編集者（Editor）",
        "gitignore_entries": [
            "config.json",
            "*.env",
            ".env.local"
        ]
    },
    "config_template": {
        "wordpress": {
            "site_url": "https://example.com",
            "username": "your_username",
            "app_password": "xxxx xxxx xxxx xxxx xxxx xxxx"
        },
        "default_settings": {
            "post_status": "draft",
            "category_ids": [1],
            "tag_ids": []
        }
    },
    "workflow": {
        "steps": [
            {
                "step": 1,
                "action": "設定ファイル準備",
                "description": "config.jsonにWordPress認証情報を設定"
            },
            {
                "step": 2,
                "action": "HTMLファイル準備",
                "description": "工程12で生成したHTMLファイルを用意"
            },
            {
                "step": 3,
                "action": "画像準備（オプション）",
                "description": "アイキャッチ画像を用意"
            },
            {
                "step": 4,
                "action": "スクリプト実行",
                "description": "wp_auto_post.pyを実行"
            },
            {
                "step": 5,
                "action": "WordPress確認",
                "description": "管理画面で下書きを確認"
            },
            {
                "step": 6,
                "action": "画像置換",
                "description": "プレースホルダーを実際の画像に置換"
            },
            {
                "step": 7,
                "action": "公開",
                "description": "確認後、記事を公開"
            }
        ]
    },
    "cli_options": {
        "required": {
            "--html": "HTMLファイルパス",
            "--title": "記事タイトル"
        },
        "optional": {
            "--eyecatch": "アイキャッチ画像パス",
            "--category": "カテゴリID",
            "--tags": "タグ（カンマ区切り）",
            "--status": "draft / publish / pending（デフォルト: draft）",
            "--config": "設定ファイルパス（デフォルト: config.json）"
        }
    },
    "output_format": {
        "success": {
            "post_id": "作成された投稿ID",
            "status": "投稿ステータス",
            "edit_url": "WordPress編集画面URL",
            "preview_url": "プレビューURL",
            "media_id": "アップロードされた画像ID（あれば）",
            "media_url": "画像URL（あれば）"
        }
    }
}
