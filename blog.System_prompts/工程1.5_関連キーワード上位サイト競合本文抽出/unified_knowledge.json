{
  "process_info": {
    "process_id": "1.5",
    "process_name": "関連キーワード上位サイト競合本文抽出",
    "version": "1.0.0",
    "created_date": "2024-12-22",
    "purpose": "工程0の関連キーワードごとに上位サイトの本文を抽出し、工程2以降の材料を強化する",
    "position_in_pipeline": "工程1と工程2の間"
  },
  "guidelines": {
    "extraction_principles": {
      "description": "関連キーワード抽出の基本原則",
      "items": [
        {
          "id": "G1",
          "title": "抽出根拠の明確化",
          "content": "どのKWで、どのURLから、何を取得したかを必ず記録する。曖昧な抽出は禁止。"
        },
        {
          "id": "G2",
          "title": "工程1との重複回避",
          "content": "工程1で既に取得済みのURLは除外する。重複がある場合はnotesに明記。"
        },
        {
          "id": "G3",
          "title": "データドリブン",
          "content": "主観的判断ではなく、客観的データに基づく抽出。文字数や構造を数値で記録。"
        },
        {
          "id": "G4",
          "title": "10ファイル制限への配慮",
          "content": "出力は2ファイル（CSV + MD）に限定。工程2への引き渡し時にファイル数を圧迫しない。"
        },
        {
          "id": "G5",
          "title": "ABテスト対応",
          "content": "keyword_variants.jsonがある場合、variantA（重複排除）とvariantB（重複許容）の両方をカバー。"
        }
      ]
    },
    "extraction_scope": {
      "description": "抽出対象の範囲",
      "target_kw_count": "上位5〜10個の関連KW",
      "sites_per_kw": "各KWごとに上位3〜5サイト",
      "extraction_elements": [
        "タイトル",
        "URL",
        "本文テキスト（ヘッダー・フッター・広告除外）",
        "文字数",
        "順位",
        "抽出日時（ISO 8601形式）"
      ]
    },
    "quality_criteria": {
      "description": "抽出品質の基準",
      "items": [
        {
          "criteria": "本文のみ抽出",
          "detail": "ヘッダー、フッター、サイドバー、広告は除外"
        },
        {
          "criteria": "最低文字数",
          "detail": "500文字以上の本文を抽出対象とする"
        },
        {
          "criteria": "言語",
          "detail": "日本語コンテンツのみを対象"
        },
        {
          "criteria": "コンテンツタイプ",
          "detail": "記事ページのみ（商品ページ、カテゴリページは除外）"
        }
      ]
    }
  },
  "templates": {
    "csv_output": {
      "description": "CSV出力フォーマット",
      "columns": [
        {
          "name": "related_kw",
          "type": "string",
          "description": "関連キーワード",
          "example": "派遣社員 教育計画"
        },
        {
          "name": "url",
          "type": "string",
          "description": "抽出元URL",
          "example": "https://example.com/article/..."
        },
        {
          "name": "title",
          "type": "string",
          "description": "ページタイトル",
          "example": "派遣社員の教育計画立て方ガイド"
        },
        {
          "name": "extracted_text",
          "type": "string",
          "description": "抽出した本文テキスト",
          "example": "派遣社員の教育計画を立てる際には..."
        },
        {
          "name": "word_count",
          "type": "integer",
          "description": "本文の文字数",
          "example": 2500
        },
        {
          "name": "notes",
          "type": "string",
          "description": "備考（順位、特徴等）",
          "example": "上位1位、実践的なテンプレートあり"
        },
        {
          "name": "captured_at",
          "type": "string",
          "format": "ISO 8601",
          "description": "抽出日時",
          "example": "2024-12-22T10:00:00Z"
        }
      ]
    },
    "summary_md_structure": {
      "description": "サマリーMarkdownの構造",
      "sections": [
        {
          "level": "H1",
          "title": "工程1.5 関連キーワード上位サイト競合本文抽出サマリー"
        },
        {
          "level": "H2",
          "title": "抽出概要",
          "content": [
            "対象関連KW数",
            "抽出サイト総数",
            "抽出日時",
            "ABテスト対応状況"
          ]
        },
        {
          "level": "H2",
          "title": "関連KWごとの抽出結果",
          "content": "各KWをH3で分割し、表形式で結果を表示"
        },
        {
          "level": "H2",
          "title": "工程2以降への引き継ぎ事項",
          "content": [
            "特に注目すべきトピック",
            "競合に見られない視点",
            "推奨する深掘りポイント"
          ]
        }
      ]
    }
  },
  "examples": {
    "csv_row_example": {
      "related_kw": "派遣社員 教育計画",
      "url": "https://example.com/haken-kyouiku-keikaku",
      "title": "派遣社員の教育計画立て方【2024年版テンプレート付き】",
      "extracted_text": "派遣社員の教育計画を効果的に立てるためには、まず現状のスキル評価から始めることが重要です。具体的には、①入社時のスキルチェック、②定期的な評価面談、③目標設定と進捗管理の3ステップが基本となります...",
      "word_count": 2800,
      "notes": "上位1位、実践的なテンプレートダウンロードあり、2024年最新データ使用",
      "captured_at": "2024-12-22T10:30:00Z"
    },
    "summary_section_example": {
      "kw": "派遣社員 教育計画",
      "results_table": [
        {
          "rank": 1,
          "title": "派遣社員の教育計画立て方【2024年版】",
          "word_count": 2800,
          "features": "実践的テンプレート、2024年最新データ"
        },
        {
          "rank": 2,
          "title": "派遣社員教育の完全ガイド",
          "word_count": 3200,
          "features": "法令対応の観点が充実"
        },
        {
          "rank": 3,
          "title": "派遣スタッフ育成計画の立て方",
          "word_count": 2100,
          "features": "中小企業向け、コスト重視"
        }
      ],
      "common_points": "すべての記事でスキル評価→目標設定→進捗管理の3ステップを推奨",
      "differentiation_opportunities": "具体的な予算配分や、リモート教育への対応が手薄"
    },
    "handover_example": {
      "notable_topics": [
        "教育計画のテンプレート化需要が高い",
        "法令対応（派遣法）との関連付けが求められている",
        "リモート・オンライン教育への対応ニーズ"
      ],
      "missing_perspectives": [
        "教育投資のROI計算方法",
        "派遣元・派遣先の役割分担の明確化",
        "教育効果の測定指標（KPI）"
      ],
      "recommended_deep_dive": [
        "テンプレートの具体例（Excel形式等）",
        "成功事例・失敗事例の対比",
        "専門家インタビューや統計データの引用"
      ]
    }
  },
  "checklist": {
    "pre_extraction": [
      {
        "id": "PRE1",
        "item": "工程0_キーワード選定結果.jsonが読み込まれているか",
        "required": true
      },
      {
        "id": "PRE2",
        "item": "工程1のCSVで既存URLがリストアップされているか",
        "required": true
      },
      {
        "id": "PRE3",
        "item": "keyword_variants.jsonの有無を確認したか",
        "required": true
      },
      {
        "id": "PRE4",
        "item": "抽出対象の関連KWが5〜10個に絞られているか",
        "required": true
      }
    ],
    "during_extraction": [
      {
        "id": "DUR1",
        "item": "各KWごとに上位3〜5サイトを抽出しているか",
        "required": true
      },
      {
        "id": "DUR2",
        "item": "工程1との重複URLを除外しているか",
        "required": true
      },
      {
        "id": "DUR3",
        "item": "本文のみを抽出しているか（ヘッダー・広告除外）",
        "required": true
      },
      {
        "id": "DUR4",
        "item": "抽出日時をISO 8601形式で記録しているか",
        "required": true
      }
    ],
    "post_extraction": [
      {
        "id": "POST1",
        "item": "CSVファイルが正しいフォーマットで生成されているか",
        "required": true
      },
      {
        "id": "POST2",
        "item": "サマリーMDが構造化されているか",
        "required": true
      },
      {
        "id": "POST3",
        "item": "出力ファイルが2件（CSV + MD）のみか",
        "required": true
      },
      {
        "id": "POST4",
        "item": "工程2以降への引き継ぎ事項が明記されているか",
        "required": true
      },
      {
        "id": "POST5",
        "item": "ABテスト対応状況が記載されているか",
        "required": true
      }
    ]
  },
  "integration": {
    "input_from": [
      {
        "process": "工程0",
        "file": "工程0_キーワード選定結果.json",
        "fields_used": ["related_keywords", "main_keyword"]
      },
      {
        "process": "工程0",
        "file": "keyword_variants.json",
        "fields_used": ["variantA_dedup", "variantB_dup", "common"],
        "optional": true
      },
      {
        "process": "工程1",
        "file": "工程1_1.1統合_上位10サイト競合記事本文.csv",
        "purpose": "重複URL回避用"
      }
    ],
    "output_to": [
      {
        "process": "工程2",
        "file": "step1_5_related_kw_competitor_extract.csv",
        "purpose": "CSV読み込み・初期化に含める"
      },
      {
        "process": "工程3A/3B/3C",
        "file": "step1_5_related_kw_competitor_extract_summary.md",
        "purpose": "分析材料として参照"
      },
      {
        "process": "工程4以降",
        "file": "step1_5_related_kw_competitor_extract_summary.md",
        "purpose": "網羅性チェックに活用"
      }
    ]
  },
  "ab_test_support": {
    "description": "ABテスト対応の詳細",
    "when_keyword_variants_exists": {
      "variantA_handling": {
        "description": "重複排除版（variantA_dedup）の処理",
        "extraction_priority": "網羅性重視、ノイズ低減",
        "kw_selection": "重複なしKWから上位を選択"
      },
      "variantB_handling": {
        "description": "重複許容版（variantB_dup）の処理",
        "extraction_priority": "強調パターン重視",
        "kw_selection": "意図的に重複するKWも含める"
      },
      "summary_structure": {
        "description": "サマリーMDでのA/B分離",
        "sections": [
          "## Variant A（重複排除）向け抽出結果",
          "## Variant B（重複許容）向け抽出結果",
          "## 共通の引き継ぎ事項"
        ]
      }
    },
    "when_keyword_variants_not_exists": {
      "handling": "通常の関連KW抽出を実施",
      "ab_status": "N/A"
    }
  }
}
