#!/bin/bash
# pre-push hook: main/masterへの直接pushを禁止（developは許可）

protected_branches=("main" "master")
current_branch=$(git symbolic-ref --short HEAD)

for branch in "${protected_branches[@]}"; do
    if [[ "$current_branch" == "$branch" ]]; then
        echo ""
        echo "⚠️  直接 $branch への push は禁止されています"
        echo ""
        echo "正しいワークフロー:"
        echo "  1. ./scripts/worktree.sh create <topic>"
        echo "  2. feature ブランチで作業"
        echo "  3. PR を作成してマージ"
        echo ""
        echo "緊急時の回避（非推奨）:"
        echo "  git push --no-verify"
        echo ""
        exit 1
    fi
done

exit 0
