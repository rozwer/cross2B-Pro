# 掛け算の交換法則の形式的証明

> Agdaを用いて「掛け算において書け順が固定されない」ことを機械的に検証する

## 証明する命題

### 日本語での表現

**「掛け算において、掛ける順序（書け順）は結果に影響しない」**

- 「3 × 5」と「5 × 3」は同じ値になる
- どちらの順序で書いても数学的に等価である

### 形式的な表現（数学記号）

```
∀ m, n ∈ ℕ. m × n = n × m
```

（任意の自然数 m, n に対して、m × n と n × m は等しい）

### Agdaでの表現

```agda
*-comm : ∀ (m n : ℕ) → m * n ≡ n * m
```

**式と命題の対応:**

| Agdaの式 | 数学的意味 |
|----------|------------|
| `∀ (m n : ℕ)` | 任意の自然数 m, n に対して |
| `m * n` | m × n（m と n の積） |
| `≡` | 等しい（propositional equality） |
| `n * m` | n × m（n と m の積） |
| `→` | ならば（この場合「〜が成り立つ」） |

**型全体の意味:**
「任意の自然数 m, n を与えると、m × n = n × m の証明を返す関数」

---

## 証明の構造

### 1. 補題1: 右ゼロ則

```
命題: ∀ n. n × 0 = 0
Agda: *-zeroʳ : ∀ (n : ℕ) → n * zero ≡ zero
```

任意の数に右から0を掛けると0になる。

### 2. 補題2: 右サクセサ則

```
命題: ∀ m n. m × (1 + n) = m + m × n
Agda: *-sucʳ : ∀ (m n : ℕ) → m * suc n ≡ m + m * n
```

右側の数が1増えると、結果は左側の数だけ増える。

### 3. 主定理: 交換法則

```
命題: ∀ m n. m × n = n × m
Agda: *-comm : ∀ (m n : ℕ) → m * n ≡ n * m
```

補題1と補題2を使って、帰納法で証明。

---

## 検証結果

**Agdapad での型チェック: 成功（exit code 0）**

型チェックが通ったことにより、掛け算の交換法則 `m × n = n × m` が機械的に証明されました。

## ファイル構成

```
agda-proof/
├── README.md           # このファイル（説明文書）
└── Commutativity.agda  # 交換法則の証明（自己完結版、検証済み）
```

---

## 証明の正しさの保証

### Curry-Howard 対応（型と命題の対応）

Agdaは依存型を持つプログラミング言語であり、以下の対応が成り立つ：

| プログラミング | 論理学 |
|----------------|--------|
| 型 | 命題 |
| プログラム（値） | 証明 |
| 型チェックが通る | 証明が正しい |

### 検証の意味

- **型チェックが通る** = 証明が論理的に正しい
- Agdaコンパイラが機械的に検証するため、人間のミスが入り込まない
- このファイルが型チェックを通れば、交換法則は数学的に証明されたことになる

---

## 実行方法

### オンライン（推奨）

**[Agdapad](https://agdapad.quasicoherent.io/)** にアクセスし、`Commutativity.agda` の内容を貼り付ける。
（注: モジュール名を `module source where` に変更すること）

### ローカル

```bash
# Agdaのインストール（Ubuntu/Debian）
sudo apt install agda agda-stdlib

# 型チェック実行
agda Multiplication.agda
```

### 期待される結果

- **成功**: エラーなしで終了 → 証明が正しい
- **失敗**: 型エラーが表示される → 証明に誤りがある

---

## 教育的補足

### なぜ交換法則の証明が必要なのか？

「3 × 5 = 5 × 3」は直感的には明らかだが、数学的には以下の理由で証明が必要：

1. **掛け算の定義は非対称**
   - Agdaでの定義: `0 * n = 0`, `(1+m) * n = n + m*n`
   - 左から掛ける場合と右から掛ける場合で定義が異なる

2. **定義から自明ではない**
   - `0 * n = 0` は定義から直接
   - `n * 0 = 0` は帰納法が必要（補題1）

3. **一般の代数では成り立たない**
   - 行列の掛け算: AB ≠ BA（一般に）
   - 四元数の掛け算: 非可換

---

## 参考文献

- [Agda公式ドキュメント](https://agda.readthedocs.io/)
- [Programming Language Foundations in Agda](https://plfa.github.io/)
- [Agda標準ライブラリ](https://github.com/agda/agda-stdlib)
