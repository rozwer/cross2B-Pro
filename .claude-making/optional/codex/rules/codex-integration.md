---
description: Codex CLI の使用ガイドライン
---

## Codex とは

OpenAI Codex CLI - コード分析・レビュー・実行のためのツール。
Claude Code とは別の AI エンジンを使用するため、**セカンドオピニオン**として有効。

---

## 呼び出し方法

### 推奨: @codex-reviewer サブエージェント経由

```
@codex-reviewer に以下をレビュー依頼:
- 対象ファイル: src/main.py
- 観点: セキュリティ / パフォーマンス / 可読性
```

**メリット**:
- Claude Code のコンテキストを活用
- 結果を自動で統合
- エラーハンドリング済み

### 手動: Bash 経由

```bash
# 環境変数を読み込み
source .codex/env.sh

# 未コミット変更をレビュー
codex review --uncommitted "レビュー観点"

# 特定ファイルをレビュー
codex review src/main.py "セキュリティ観点でレビュー"

# TUI モード（対話的）
codex
```

---

## レビュー観点

### セキュリティ

```
- OWASP Top 10
- 認証・認可
- 入力検証
- 秘密情報の扱い
```

### パフォーマンス

```
- N+1 クエリ
- 不要なループ
- メモリ使用量
- 非同期処理
```

### 可読性

```
- 命名規則
- コメントの適切性
- 関数の分割
- 型アノテーション
```

---

## 出力形式

Codex のレビュー結果は以下の形式で出力：

```markdown
## High Priority

- [指摘内容]
  - 根拠: ...
  - 修正案: ...

## Medium Priority

- [指摘内容]
  - 根拠: ...
  - 修正案: ...

## Low Priority

- [指摘内容]
  - 根拠: ...
  - 修正案: ...
```

---

## 注意事項

### 1. 環境変数

Codex を使用する前に環境変数を読み込む：

```bash
source .codex/env.sh
```

### 2. トークン上限

- 大きなファイルは分割して送信
- 必要な部分のみを抽出
- コンテキストは最小限に

### 3. 結果の検証

Codex の提案は必ず検証：

```
- 提案が技術的に正しいか
- プロジェクトの方針に合っているか
- 既存コードとの整合性
```

### 4. Claude Code との連携

```
1. Claude Code で実装
2. @codex-reviewer でレビュー
3. 指摘を Claude Code で修正
4. 必要に応じて再レビュー
```

---

## トラブルシューティング

| 症状 | 原因 | 解決策 |
|------|------|--------|
| `codex: command not found` | パス未設定 | `source .codex/env.sh` |
| API エラー | トークン期限切れ | `.codex/env.sh` の API キーを確認 |
| レスポンスが遅い | ファイルが大きい | 対象を絞る |
| 結果が的外れ | コンテキスト不足 | 観点を明確に指定 |
