# 工程構成変更 - フェーズ別実装計画

## 変更概要

現行の13工程（step0-step11）から、新構成への移行を行う。

### 新旧対応表

| 新工程 | 現状 | 変更内容 |
|--------|------|----------|
| 工程-1（ヒアリング） | 未実装 | **新規追加** - UI入力フォーム |
| 工程0（キーワード選定） | step0 | 変更なし |
| 工程1（競合本文CSV） | step1 | 変更なし |
| 工程1.5（関連KW競合抽出） | 未実装 | **新規追加** - オプション工程 |
| 工程2（CSV確認） | step2 | 入力に工程1.5を追加 |
| 工程3A/3B/3C（並列分析） | step3a/3b/3c | 変更なし |
| 工程3.5（人間味生成） | 未実装 | **新規追加** - 承認後の最初の工程 |
| 工程4（アウトライン初回） | step4 | 入力に工程3.5を追加 |
| 工程5（一次情報追加） | step5 | 変更なし |
| 工程6（アウトライン再生成） | step6 | 変更なし |
| 工程6.5（構成案作成） | step6_5 | 出力形式を確認（10ファイル上限） |
| 工程7A（本文生成初稿） | step7a | 入力ファイルを調整 |
| 工程7B（ブラッシュアップ） | step7b | 変更なし |
| 工程8（ファクトチェック） | step8 | 変更なし |
| 工程9（最終リライト） | step9 | 変更なし |
| 工程10（最終出力4記事） | step10 | **変更** - 4記事出力に |
| 工程11（画像提案） | step11 | 変更なし |
| 工程12（WordPress HTML） | 未実装 | **新規追加** |

---

## フェーズ分割理由

### Phase 1: 新規工程の追加（独立性高）
- 工程1.5, 工程3.5, 工程12 は既存コードへの影響が少ない
- 並列で実装可能

### Phase 2: 既存工程の入力調整
- 工程2, 工程4, 工程7A の入力ファイル変更
- Phase 1 完了後に実施

### Phase 3: ワークフロー統合
- Temporal Workflow の工程順序変更
- LangGraph グラフの再構成

### Phase 4: 工程10の出力変更
- 4記事出力への変更は単独で実施可能
- プロンプト変更が主

### Phase 5: 工程-1（UI）
- フロントエンドのみの変更
- 他と独立して実施可能

---

## 依存関係

```
Phase 5 (工程-1 UI) ─────────────────────────────────────────┐
                                                              │
Phase 1A (工程1.5) ──┐                                        │
                     ├─→ Phase 2A (工程2 入力調整) ──┐        │
Phase 1B (工程3.5) ──┤                               │        │
                     ├─→ Phase 2B (工程4 入力調整) ──┼─→ Phase 3 (統合)
Phase 1C (工程12)  ──┘                               │        │
                     ┌─→ Phase 2C (工程7A 入力調整) ─┘        │
Phase 4 (工程10変更) ┘                                        │
                                                              │
                                        ←─────────────────────┘
```

---

## 並列作業セッション割り当て

| セッション | 担当フェーズ | 依存 |
|------------|--------------|------|
| Session A | Phase 1A (工程1.5) | なし |
| Session B | Phase 1B (工程3.5) | なし |
| Session C | Phase 1C (工程12) | なし |
| Session D | Phase 4 (工程10変更) | なし |
| Session E | Phase 5 (工程-1 UI) | なし |
| Session F | Phase 2 + 3 (統合) | A,B,C,D 完了後 |
