# Backend çµ±åˆä¿®æ­£è¨ˆç”»ï¼ˆPlans1ï¼‰

> **ä½œæˆæ—¥**: 2026-01-12
> **ç›®çš„**: API/DB/Storage é–¢é€£ã®ãƒã‚°ä¿®æ­£ï¼ˆPlans6ã€œ10çµ±åˆï¼‰
> **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ãƒ•ã‚§ãƒ¼ã‚º0-1å®Œäº†ã€ãƒ•ã‚§ãƒ¼ã‚º2é€²è¡Œä¸­
> **ä¸¦åˆ—ä½œæ¥­**: Plans2 (Worker), Plans3 (Frontend) ã¨ç«¶åˆãªã—

---

## æ¦‚è¦

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆAPI/DB/Storageï¼‰é–¢é€£ã®å•é¡Œã‚’ä¿®æ­£ã—ã¾ã™ã€‚

| ãƒ•ã‚§ãƒ¼ã‚º | å†…å®¹ | ä»¶æ•° |
|---------|------|------|
| 0 | CRITICALï¼ˆå³æ™‚å¯¾å¿œï¼‰ | 8ä»¶ |
| 1 | HIGHï¼ˆæ—©æœŸå¯¾å¿œï¼‰ | 10ä»¶ |
| 2 | MEDIUMï¼ˆä¸­æœŸå¯¾å¿œï¼‰ | 12ä»¶ |
| 3 | LOWï¼ˆæ”¹å–„ï¼‰ | 5ä»¶ |
| 4 | ãƒ†ã‚¹ãƒˆè¿½åŠ  | - |

---

## ğŸ”´ ãƒ•ã‚§ãƒ¼ã‚º0: CRITICAL âœ… å®Œäº†

### 0-1. [CRITICAL] MinIO Response ãƒªã‚½ãƒ¼ã‚¹ãƒªãƒ¼ã‚¯ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [artifact_store.py:253-271](apps/api/storage/artifact_store.py#L253)
**å•é¡Œ**: `response.read()` ãŒä¾‹å¤–ã‚’ç™ºç”Ÿã—ãŸå ´åˆã€æ¥ç¶šãŒãƒªãƒ¼ã‚¯ã™ã‚‹
**ä¿®æ­£æ–¹é‡**: try-finally ã§ãƒªã‚½ãƒ¼ã‚¹è§£æ”¾ã‚’ä¿è¨¼
**å·¥æ•°**: 30åˆ†

```python
try:
    response = self.client.get_object(...)
    content = response.read()
finally:
    response.close()
    response.release_conn()
```

---

### 0-2. [CRITICAL] N+1 Query: cost.py Step lookup in loop âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [cost.py:161-166](apps/api/routers/cost.py#L161)
**å•é¡Œ**: artifacts ãƒ«ãƒ¼ãƒ—å†…ã§æ¯å› Step ã‚’å€‹åˆ¥ã‚¯ã‚¨ãƒª
**ä¿®æ­£æ–¹é‡**: äº‹å‰ã«å…¨ Step ã‚’å–å¾—ã—ã¦ãƒãƒƒãƒ”ãƒ³ã‚°ä½œæˆ
**å·¥æ•°**: 25åˆ†

---

### 0-3. [CRITICAL] N+1 Query: artifacts.py eager loading æœªä½¿ç”¨ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [artifacts.py:116-124](apps/api/routers/artifacts.py#L116)
**å•é¡Œ**: Steps ã¨ Artifacts ã‚’åˆ¥ã‚¯ã‚¨ãƒªã§å–å¾—
**ä¿®æ­£æ–¹é‡**: `selectinload` ã‚’ä½¿ç”¨ã—ã¦1ã‚¯ã‚¨ãƒªã§å–å¾—
**å·¥æ•°**: 25åˆ†

---

### 0-4. [CRITICAL] Unchecked path parsing in schemas.py âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [schemas.py:43-62](apps/api/storage/schemas.py#L43)
**å•é¡Œ**: ãƒ‘ã‚¹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒç©ºæ–‡å­—åˆ—ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ãªã„
**ä¿®æ­£æ–¹é‡**: ç©ºæ–‡å­—åˆ—ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ 
**å·¥æ•°**: 20åˆ†

---

### 0-5. [CRITICAL] Cascade Delete ã¨æ‰‹å‹• Delete ã®é‡è¤‡ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:1316-1318](apps/api/routers/runs.py#L1316)
**å•é¡Œ**: cascade="all, delete-orphan" è¨­å®šæ¸ˆã¿ãªã®ã«æ‰‹å‹•å‰Šé™¤ã‚‚å®Ÿè¡Œ
**ä¿®æ­£æ–¹é‡**: æ‰‹å‹•å‰Šé™¤ã‚’å‰Šé™¤ã—ã€`session.delete(run)` ã®ã¿ã«ä¾å­˜
**å·¥æ•°**: 10åˆ†

---

### 0-6. [CRITICAL] datetime.utcnow() vs datetime.now() ä¸æ•´åˆ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:1382](apps/api/routers/runs.py#L1382)
**å•é¡Œ**: `datetime.utcnow()` ã¨ `datetime.now()` ãŒæ··åœ¨
**ä¿®æ­£æ–¹é‡**: `datetime.now()` ã«çµ±ä¸€
**å·¥æ•°**: 5åˆ†

---

### 0-7. [CRITICAL] ErrorLog.step_id å‹ä¸æ•´åˆï¼ˆInteger vs UUIDï¼‰ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [models.py:236](apps/api/db/models.py#L236)
**å•é¡Œ**: models.py ã§ã¯ Integer ã ãŒ init-db.sql ã§ã¯ UUID
**ä¿®æ­£æ–¹é‡**: UUIDå‹ã«çµ±ä¸€ï¼ˆãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
**å·¥æ•°**: 30åˆ†

---

### 0-8. [CRITICAL] Alembicãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ - triggeré–¢æ•°æœªå®šç¾© âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [20241223_add_hearing_templates.py:55-61](apps/api/db/migrations/versions/20241223_add_hearing_templates.py#L55)
**å•é¡Œ**: `update_updated_at_column()` é–¢æ•°ãŒãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§æœªå®šç¾©
**ä¿®æ­£æ–¹é‡**: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«é–¢æ•°å®šç¾©ã‚’è¿½åŠ 
**å·¥æ•°**: 30åˆ†

---

## ğŸŸ  ãƒ•ã‚§ãƒ¼ã‚º1: HIGH âœ… å®Œäº†

### 1-1. [HIGH] runs.py scalar_one() NoResultFound æœªå‡¦ç†ï¼ˆè¿½åŠ ç®‡æ‰€ï¼‰ `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:208, 224-235](apps/api/routers/runs.py#L208)
**å•é¡Œ**: Run ãŒå­˜åœ¨ã—ãªã„å ´åˆã« NoResultFound ä¾‹å¤–
**ä¿®æ­£æ–¹é‡**: `scalar_one_or_none()` + None ãƒã‚§ãƒƒã‚¯
**å·¥æ•°**: 20åˆ†

---

### 1-2. [HIGH] Audit log flush without commit atomicity `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [audit.py:161-162](apps/api/db/audit.py#L161)
**å•é¡Œ**: flush å¾Œã«ä¾‹å¤–ç™ºç”Ÿã™ã‚‹ã¨ç›£æŸ»ãƒ­ã‚°ãŒå¤±ã‚ã‚Œã‚‹
**ä¿®æ­£æ–¹é‡**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
**å·¥æ•°**: 10åˆ†

---

### 1-3. [HIGH] Silent exception swallowing in cost.py/artifacts.py `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [cost.py:182-184](apps/api/routers/cost.py#L182), [artifacts.py:167-169](apps/api/routers/artifacts.py#L167)
**å•é¡Œ**: ã‚µã‚¤ãƒ¬ãƒ³ãƒˆå¤±æ•—ï¼ˆãƒ­ã‚°å‡ºåŠ›ãªã—ã® continueï¼‰
**ä¿®æ­£æ–¹é‡**: é©åˆ‡ãªãƒ­ã‚°å‡ºåŠ›ã‚’è¿½åŠ 
**å·¥æ•°**: 20åˆ†

---

### 1-4. [HIGH] artifact_store.py path validation gap `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [artifact_store.py:156-184](apps/api/storage/artifact_store.py#L156)
**å•é¡Œ**: ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«æ”»æ’ƒã®å¯èƒ½æ€§ï¼ˆ`..` ã‚’å«ã‚€ãƒ‘ã‚¹ï¼‰
**ä¿®æ­£æ–¹é‡**: ãƒ‘ã‚¹ãƒˆãƒ©ãƒãƒ¼ã‚µãƒ«é˜²æ­¢ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ 
**å·¥æ•°**: 25åˆ†

---

### 1-5. [HIGH] Transaction isolation unspecified in tenant.py `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [tenant.py:166-194](apps/api/db/tenant.py#L166)
**å•é¡Œ**: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³åˆ†é›¢ãƒ¬ãƒ™ãƒ«ãŒæ˜ç¤ºã•ã‚Œã¦ã„ãªã„
**ä¿®æ­£æ–¹é‡**: åˆ†é›¢ãƒ¬ãƒ™ãƒ«ã‚’æŒ‡å®šå¯èƒ½ã«
**å·¥æ•°**: 30åˆ†

---

### 1-6. [HIGH] WebSocket broadcast ã®ãƒ†ãƒŠãƒ³ãƒˆåˆ†é›¢å¼·åŒ– `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [websocket.py:48-58](apps/api/routers/websocket.py#L48)
**å•é¡Œ**: `broadcast()` ã« tenant_id ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒãªã„
**ä¿®æ­£æ–¹é‡**: ConnectionManager ã« tenant_id ã‚’è¿½åŠ 
**å·¥æ•°**: 60åˆ†

---

### 1-7. [HIGH] validate_tenant_id æœªä½¿ç”¨å•é¡Œ `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [tenant.py:35-46](apps/api/db/tenant.py#L35)
**å•é¡Œ**: `get_session()` ã§ `validate_tenant_id()` ã‚’å‘¼ã³å‡ºã—ã¦ã„ãªã„
**ä¿®æ­£æ–¹é‡**: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³è¿½åŠ 
**å·¥æ•°**: 10åˆ†

---

### 1-8. [HIGH] _get_tenant_db_url ã®å…¥åŠ›æ¤œè¨¼è¿½åŠ  `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [tenant.py](apps/api/db/tenant.py)
**å•é¡Œ**: tenant_id ã®äºŒé‡æ¤œè¨¼ãŒä¸è¶³
**ä¿®æ­£æ–¹é‡**: `_get_tenant_db_url()` ã§ã‚‚æ¤œè¨¼
**å·¥æ•°**: 10åˆ†

---

### 1-9. [HIGH] TenantDBManager ã® _get_or_create_engine ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [tenant.py:132-146](apps/api/db/tenant.py#L132)
**å•é¡Œ**: åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã«è¤‡æ•°ã‚¨ãƒ³ã‚¸ãƒ³ä½œæˆ
**ä¿®æ­£æ–¹é‡**: `asyncio.Lock` ã‚’ä½¿ç”¨
**å·¥æ•°**: 20åˆ†

---

### 1-10. [HIGH] æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ã®æ¬ å¦‚ã«ã‚ˆã‚‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç«¶åˆ `cc:TODO`
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:406-408](apps/api/routers/runs.py#L406)
**å•é¡Œ**: ä»–ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒåŒæ™‚ã«æ›´æ–°ã—ãŸå ´åˆã€æœ€å¾Œã®æ›¸ãè¾¼ã¿ãŒå‹ã¤
**ä¿®æ­£æ–¹é‡**: æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ï¼ˆupdated_at ãƒã‚§ãƒƒã‚¯ï¼‰ã‚’è¿½åŠ 
**å·¥æ•°**: 45åˆ†

---

## ğŸŸ¡ ãƒ•ã‚§ãƒ¼ã‚º2: MEDIUM âœ…

### 2-1. [MEDIUM] websocket.py run_id æ¤œè¨¼å¼·åŒ–ä¸è¶³ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [websocket.py:241-245](apps/api/routers/websocket.py#L241)
**å•é¡Œ**: DB ã‚¨ãƒ©ãƒ¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é•åãŒåŒã˜ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
**ä¿®æ­£æ–¹é‡**: ã‚¨ãƒ©ãƒ¼ç†ç”±ã‚’åŒºåˆ¥
**å·¥æ•°**: 20åˆ†

---

### 2-2. [MEDIUM] runs.py bulk_delete ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä¸çµ±ä¸€ âœ… (ãƒ•ã‚§ãƒ¼ã‚º0ã§å¯¾å¿œæ¸ˆã¿)
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:1382](apps/api/routers/runs.py#L1382)
**å•é¡Œ**: utcnow() ã¨ now() ãŒæ··åœ¨
**ä¿®æ­£æ–¹é‡**: datetime.now() ã«çµ±ä¸€
**å·¥æ•°**: 5åˆ†

---

### 2-3. [MEDIUM] runs.py approve/reject flush vs commit ã®æ›–æ˜§æ€§ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:407-410](apps/api/routers/runs.py#L407)
**å•é¡Œ**: flush ã®ã¿ã§ commit ã¯ context manager ä»»ã›
**ä¿®æ­£æ–¹é‡**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
**å·¥æ•°**: 10åˆ†

---

### 2-4. [MEDIUM] AuditLogger ã®ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ç·©å’Œ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [audit.py:94-152](apps/api/db/audit.py#L94)
**å•é¡Œ**: ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ã®å¯èƒ½æ€§
**ä¿®æ­£æ–¹é‡**: `SELECT FOR UPDATE SKIP LOCKED` ã‚’ä½¿ç”¨
**å·¥æ•°**: 20åˆ†

---

### 2-5. [MEDIUM] Artifact ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ  âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [models.py:170-171](apps/api/db/models.py#L170)
**å•é¡Œ**: `Artifact.run_id` ã¨ `Artifact.step_id` ã«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒãªã„
**ä¿®æ­£æ–¹é‡**: index=True ã‚’è¿½åŠ 
**å·¥æ•°**: 15åˆ†

---

### 2-6. [MEDIUM] Run.step11_state ã‚¹ã‚­ãƒ¼ãƒæœªå®šç¾© âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [models.py:121](apps/api/db/models.py#L121)
**å•é¡Œ**: æ§‹é€ ãŒæ›–æ˜§
**ä¿®æ­£æ–¹é‡**: Pydantic ãƒ¢ãƒ‡ãƒ«ã§ Step11State ã‚’å®šç¾©
**å·¥æ•°**: 45åˆ†

---

### 2-7. [MEDIUM] CreateRunInput.step_configs ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¬ è½ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [schemas/runs.py:81](apps/api/schemas/runs.py#L81)
**å•é¡Œ**: é‡è¤‡ step_idã€ç„¡åŠ¹ step_id ã®ãƒã‚§ãƒƒã‚¯ãªã—
**ä¿®æ­£æ–¹é‡**: `@field_validator` ã§æ¤œè¨¼
**å·¥æ•°**: 25åˆ†

---

### 2-8. [MEDIUM] æ¥ç¶šãƒ—ãƒ¼ãƒ«ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æœªè¨­å®š âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [tenant.py:111-115](apps/api/db/tenant.py#L111)
**å•é¡Œ**: `pool_pre_ping=True` ãŒãªã„
**ä¿®æ­£æ–¹é‡**: è¿½åŠ 
**å·¥æ•°**: 20åˆ†

---

### 2-9. [MEDIUM] è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¸è¶³ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [models.py](apps/api/db/models.py)
**å•é¡Œ**: `(tenant_id, status)` è¤‡åˆã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãªã—
**ä¿®æ­£æ–¹é‡**: `__table_args__` ã§ Index å®šç¾©ã‚’è¿½åŠ 
**å·¥æ•°**: 30åˆ†

---

### 2-10. [MEDIUM] Artifact ä¸€è¦§ã®ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³æ¬ å¦‚ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [artifacts.py:143-194](apps/api/routers/artifacts.py#L143)
**å•é¡Œ**: æ•°åƒã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸€åº¦ã«å‡¦ç†
**ä¿®æ­£æ–¹é‡**: ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…
**å·¥æ•°**: 30åˆ†

---

### 2-11. [MEDIUM] runs.py clone_run modelConfig ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:1093-1100](apps/api/routers/runs.py#L1093)
**å•é¡Œ**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãŒãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰
**ä¿®æ­£æ–¹é‡**: å®šæ•°ã‹ã‚‰å–å¾—
**å·¥æ•°**: 20åˆ†

---

### 2-12. [MEDIUM] Transaction å†…ã§ã®æ‰‹å‹• Commitï¼ˆäºŒé‡ Commitï¼‰ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:561-663](apps/api/routers/runs.py#L561)
**å•é¡Œ**: æ‰‹å‹• commit ã¨ Context manager ã®äºŒé‡ commit
**ä¿®æ­£æ–¹é‡**: æ‰‹å‹• commit ã‚’å‰Šé™¤ã€ID å–å¾—ã¯ flush ã‚’ä½¿ç”¨
**å·¥æ•°**: 30åˆ†

---

## ğŸŸ¢ ãƒ•ã‚§ãƒ¼ã‚º3: LOW âœ…

### 3-1. [LOW] runs.py step_order å®šæ•°ã®é‡è¤‡ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:522, 741](apps/api/routers/runs.py#L522)
**å•é¡Œ**: step_order ãŒè¤‡æ•°ç®‡æ‰€ã§å®šç¾©
**ä¿®æ­£æ–¹é‡**: constants.py ã«é›†ç´„
**å·¥æ•°**: 15åˆ†

---

### 3-2. [LOW] runs.py å†—é•·ãªãƒ­ã‚®ãƒ³ã‚° âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:193-194](apps/api/routers/runs.py#L193)
**å•é¡Œ**: åŒã˜æƒ…å ±ãŒè¤‡æ•°å›ãƒ­ã‚°å‡ºåŠ›
**ä¿®æ­£æ–¹é‡**: çµ±åˆ
**å·¥æ•°**: 10åˆ†

---

### 3-3. [LOW] runs.py Any å‹ã®ä¹±ç”¨ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [runs.py:46-51](apps/api/routers/runs.py#L46)
**å•é¡Œ**: å‹ãƒã‚§ãƒƒã‚«ãƒ¼ãŒæ©Ÿèƒ½ã—ãªã„
**ä¿®æ­£æ–¹é‡**: é©åˆ‡ãªå‹ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
**å·¥æ•°**: 20åˆ†

---

### 3-4. [LOW] audit_logs.created_at ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ¬ å¦‚ âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [audit.py:257](apps/api/db/audit.py#L257)
**å•é¡Œ**: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãªã—ã§ã‚¯ã‚¨ãƒªãŒé…ã„
**ä¿®æ­£æ–¹é‡**: ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 
**å·¥æ•°**: 10åˆ†

---

### 3-5. [LOW] Double-checked locking pattern documentation âœ…
**ãƒ•ã‚¡ã‚¤ãƒ«**: [tenant.py:136-163](apps/api/db/tenant.py#L136)
**å•é¡Œ**: æ„å›³ãŒã‚³ãƒ¡ãƒ³ãƒˆã•ã‚Œã¦ã„ãªã„
**ä¿®æ­£æ–¹é‡**: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
**å·¥æ•°**: 10åˆ†

---

## ğŸ”µ ãƒ•ã‚§ãƒ¼ã‚º4: ãƒ†ã‚¹ãƒˆè¿½åŠ  âœ…

### 4-1. ä¿®æ­£ç®‡æ‰€ã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ  âœ…
- [ ] MinIO ãƒªã‚½ãƒ¼ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ
- [ ] N+1 ã‚¯ã‚¨ãƒªä¿®æ­£ã®ç¢ºèªãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ã‚¹æ¤œè¨¼ãƒ†ã‚¹ãƒˆ
- [ ] æ¥½è¦³çš„ãƒ­ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ
- [ ] TenantDBManager ãƒ¬ãƒ¼ã‚¹ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

### 4-2. smoke ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ âœ…
```bash
uv run pytest tests/smoke/ -v
```

### 4-3. å‹ãƒã‚§ãƒƒã‚¯ãƒ»lint å®Ÿè¡Œ âœ…
```bash
uv run mypy apps/api --ignore-missing-imports
uv run ruff check apps/api
```

---

## å®Œäº†åŸºæº–

- [ ] å…¨ãƒ•ã‚§ãƒ¼ã‚ºã®ä¿®æ­£å®Œäº†
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè¿½åŠ ãƒ»å…¨ãƒ‘ã‚¹
- [ ] smoke ãƒ†ã‚¹ãƒˆãƒ‘ã‚¹
- [ ] å‹ãƒã‚§ãƒƒã‚¯ãƒ»lint ãƒ‘ã‚¹

---

## æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

- ã€Œ`/work Plans1.md`ã€ã§ãƒ•ã‚§ãƒ¼ã‚º0ã‹ã‚‰å®Ÿè£…é–‹å§‹
